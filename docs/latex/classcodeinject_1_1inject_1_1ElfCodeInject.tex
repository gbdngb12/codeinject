\hypertarget{classcodeinject_1_1inject_1_1ElfCodeInject}{}\doxysection{codeinject\+::inject\+::Elf\+Code\+Inject\texorpdfstring{$<$}{<} T, U, V \texorpdfstring{$>$}{>} Class Template Reference}
\label{classcodeinject_1_1inject_1_1ElfCodeInject}\index{codeinject::inject::ElfCodeInject$<$ T, U, V $>$@{codeinject::inject::ElfCodeInject$<$ T, U, V $>$}}
Inheritance diagram for codeinject\+::inject\+::Elf\+Code\+Inject\texorpdfstring{$<$}{<} T, U, V \texorpdfstring{$>$}{>}\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=2.000000cm]{classcodeinject_1_1inject_1_1ElfCodeInject}
\end{center}
\end{figure}
\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
virtual bool \mbox{\hyperlink{classcodeinject_1_1inject_1_1ElfCodeInject_a8dc28abd8a5965499e540c39adcc4481}{inject\+\_\+code}} () override
\item 
\mbox{\Hypertarget{classcodeinject_1_1inject_1_1ElfCodeInject_a09790634e8f56f91ed2851471362dedb}\label{classcodeinject_1_1inject_1_1ElfCodeInject_a09790634e8f56f91ed2851471362dedb}} 
{\bfseries Elf\+Code\+Inject} (std\+::shared\+\_\+ptr$<$ \mbox{\hyperlink{classcodeinject_1_1binary_1_1ElfBinary}{codeinject\+::binary\+::\+Elf\+Binary}}$<$ T, U, V $>$ $>$, std\+::vector$<$ uint8\+\_\+t $>$ \mbox{\hyperlink{classcodeinject_1_1binary_1_1CodeBinary}{code}}, size\+\_\+t address)
\item 
void \mbox{\hyperlink{classcodeinject_1_1inject_1_1ElfCodeInject_a738ff5a19001dfce1d5bc2be8b92717d}{find\+\_\+rewriteable\+\_\+segment}} ()
\item 
void \mbox{\hyperlink{classcodeinject_1_1inject_1_1ElfCodeInject_a09122c063e2aaeb1291c154b1d494a1f}{write\+\_\+code}} ()
\item 
void \mbox{\hyperlink{classcodeinject_1_1inject_1_1ElfCodeInject_ad993aaacb60f02121642ea1498af33a4}{align\+\_\+code}} ()
\item 
void \mbox{\hyperlink{classcodeinject_1_1inject_1_1ElfCodeInject_a85ffc80b7cda419f6091c84d5e552f4a}{rewrite\+\_\+code\+\_\+section}} ()
\item 
void \mbox{\hyperlink{classcodeinject_1_1inject_1_1ElfCodeInject_aa4f50ac31ee0cfdb26067a40bee63fbd}{reorder\+\_\+shdrs}} ()
\item 
void \mbox{\hyperlink{classcodeinject_1_1inject_1_1ElfCodeInject_a42083348c8a8255b2aaff4f794a7ff49}{rewrite\+\_\+section\+\_\+name}} ()
\item 
void \mbox{\hyperlink{classcodeinject_1_1inject_1_1ElfCodeInject_a7115cf4a05ba61819b10d6bc842d3fef}{rewrite\+\_\+code\+\_\+segment}} ()
\item 
void \mbox{\hyperlink{classcodeinject_1_1inject_1_1ElfCodeInject_a1ce77fd4fbff34aa98ba59ab26bbdf45}{rewrite\+\_\+entry\+\_\+point}} ()
\end{DoxyCompactItemize}
\doxysubsubsection*{Public Member Functions inherited from \mbox{\hyperlink{classcodeinject_1_1inject_1_1CodeInject}{codeinject\+::inject\+::\+Code\+Inject}}}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{classcodeinject_1_1inject_1_1CodeInject_ad5433aa4124f313677788b7d5ab3c758}\label{classcodeinject_1_1inject_1_1CodeInject_ad5433aa4124f313677788b7d5ab3c758}} 
virtual bool {\bfseries inject\+\_\+code} ()=0
\item 
\mbox{\Hypertarget{classcodeinject_1_1inject_1_1CodeInject_a421a1b7f5be755239bdd91f3fb720772}\label{classcodeinject_1_1inject_1_1CodeInject_a421a1b7f5be755239bdd91f3fb720772}} 
{\bfseries Code\+Inject} (std\+::vector$<$ uint8\+\_\+t $>$, std\+::string inject\+\_\+name, std\+::string target\+\_\+name)
\end{DoxyCompactItemize}
\doxysubsection*{Public Attributes}
\begin{DoxyCompactItemize}
\item 
int \mbox{\hyperlink{classcodeinject_1_1inject_1_1ElfCodeInject_acfd9e5cf20f07b8c0d5dcc29bf7e7512}{m\+\_\+program\+\_\+header\+\_\+index}}
\item 
int \mbox{\hyperlink{classcodeinject_1_1inject_1_1ElfCodeInject_a4fa95bf04568136acd369533ccc03f08}{m\+\_\+name\+\_\+index}}
\item 
\mbox{\Hypertarget{classcodeinject_1_1inject_1_1ElfCodeInject_aeb6aaf11f1e0749bde7faf811a95f64f}\label{classcodeinject_1_1inject_1_1ElfCodeInject_aeb6aaf11f1e0749bde7faf811a95f64f}} 
std\+::shared\+\_\+ptr$<$ \mbox{\hyperlink{classcodeinject_1_1binary_1_1ElfBinary}{codeinject\+::binary\+::\+Elf\+Binary}}$<$ T, U, V $>$ $>$ {\bfseries m\+\_\+elf\+\_\+binary\+\_\+ptr}
\end{DoxyCompactItemize}
\doxysubsubsection*{Public Attributes inherited from \mbox{\hyperlink{classcodeinject_1_1inject_1_1CodeInject}{codeinject\+::inject\+::\+Code\+Inject}}}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{classcodeinject_1_1inject_1_1CodeInject_a6ac6560cd53855d0278860d0ff8020ef}\label{classcodeinject_1_1inject_1_1CodeInject_a6ac6560cd53855d0278860d0ff8020ef}} 
std\+::vector$<$ uint8\+\_\+t $>$ {\bfseries m\+\_\+code}
\item 
std\+::string \mbox{\hyperlink{classcodeinject_1_1inject_1_1CodeInject_a305d115f40fbaaafcb6dcc0b80c8dc0f}{m\+\_\+inject\+\_\+section\+\_\+name}}
\item 
std\+::string \mbox{\hyperlink{classcodeinject_1_1inject_1_1CodeInject_a06aeb52981ae8e6174c176976664d320}{m\+\_\+target\+\_\+section\+\_\+name}}
\item 
int \mbox{\hyperlink{classcodeinject_1_1inject_1_1CodeInject_a058f6daca07a7402567f5fc57f72f0a4}{m\+\_\+inject\+\_\+offset}}
\item 
size\+\_\+t \mbox{\hyperlink{classcodeinject_1_1inject_1_1CodeInject_a8a19d582b199d7c87672e8e89907dac5}{m\+\_\+inject\+\_\+vaddr}}
\item 
int \mbox{\hyperlink{classcodeinject_1_1inject_1_1CodeInject_a02314ba53abe30ca30dee9c9b0d56167}{m\+\_\+inject\+\_\+size}}
\item 
int \mbox{\hyperlink{classcodeinject_1_1inject_1_1CodeInject_a6712450bbd1d16953f61353daec545ba}{m\+\_\+inject\+\_\+index}}
\end{DoxyCompactItemize}


\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{classcodeinject_1_1inject_1_1ElfCodeInject_ad993aaacb60f02121642ea1498af33a4}\label{classcodeinject_1_1inject_1_1ElfCodeInject_ad993aaacb60f02121642ea1498af33a4}} 
\index{codeinject::inject::ElfCodeInject$<$ T, U, V $>$@{codeinject::inject::ElfCodeInject$<$ T, U, V $>$}!align\_code@{align\_code}}
\index{align\_code@{align\_code}!codeinject::inject::ElfCodeInject$<$ T, U, V $>$@{codeinject::inject::ElfCodeInject$<$ T, U, V $>$}}
\doxysubsubsection{\texorpdfstring{align\_code()}{align\_code()}}
{\footnotesize\ttfamily template$<$typename T , typename U , typename V $>$ \\
void \mbox{\hyperlink{classcodeinject_1_1inject_1_1ElfCodeInject}{codeinject\+::inject\+::\+Elf\+Code\+Inject}}$<$ T, U, V $>$\+::align\+\_\+code}

파일 오프셋은 나두고, 가상 메모리 주소를 정렬한다. \mbox{\Hypertarget{classcodeinject_1_1inject_1_1ElfCodeInject_a738ff5a19001dfce1d5bc2be8b92717d}\label{classcodeinject_1_1inject_1_1ElfCodeInject_a738ff5a19001dfce1d5bc2be8b92717d}} 
\index{codeinject::inject::ElfCodeInject$<$ T, U, V $>$@{codeinject::inject::ElfCodeInject$<$ T, U, V $>$}!find\_rewriteable\_segment@{find\_rewriteable\_segment}}
\index{find\_rewriteable\_segment@{find\_rewriteable\_segment}!codeinject::inject::ElfCodeInject$<$ T, U, V $>$@{codeinject::inject::ElfCodeInject$<$ T, U, V $>$}}
\doxysubsubsection{\texorpdfstring{find\_rewriteable\_segment()}{find\_rewriteable\_segment()}}
{\footnotesize\ttfamily template$<$typename T , typename U , typename V $>$ \\
void \mbox{\hyperlink{classcodeinject_1_1inject_1_1ElfCodeInject}{codeinject\+::inject\+::\+Elf\+Code\+Inject}}$<$ T, U, V $>$\+::find\+\_\+rewriteable\+\_\+segment}

PT\+\_\+\+NOTE Segment를 찾고 인덱스를 설정한다. \begin{DoxyReturn}{Returns}
못찾으면 프로그램 종료 
\end{DoxyReturn}
\mbox{\Hypertarget{classcodeinject_1_1inject_1_1ElfCodeInject_a8dc28abd8a5965499e540c39adcc4481}\label{classcodeinject_1_1inject_1_1ElfCodeInject_a8dc28abd8a5965499e540c39adcc4481}} 
\index{codeinject::inject::ElfCodeInject$<$ T, U, V $>$@{codeinject::inject::ElfCodeInject$<$ T, U, V $>$}!inject\_code@{inject\_code}}
\index{inject\_code@{inject\_code}!codeinject::inject::ElfCodeInject$<$ T, U, V $>$@{codeinject::inject::ElfCodeInject$<$ T, U, V $>$}}
\doxysubsubsection{\texorpdfstring{inject\_code()}{inject\_code()}}
{\footnotesize\ttfamily template$<$typename T , typename U , typename V $>$ \\
bool \mbox{\hyperlink{classcodeinject_1_1inject_1_1ElfCodeInject}{codeinject\+::inject\+::\+Elf\+Code\+Inject}}$<$ T, U, V $>$\+::inject\+\_\+code\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Implements \mbox{\hyperlink{classcodeinject_1_1inject_1_1CodeInject}{codeinject\+::inject\+::\+Code\+Inject}}.

\mbox{\Hypertarget{classcodeinject_1_1inject_1_1ElfCodeInject_aa4f50ac31ee0cfdb26067a40bee63fbd}\label{classcodeinject_1_1inject_1_1ElfCodeInject_aa4f50ac31ee0cfdb26067a40bee63fbd}} 
\index{codeinject::inject::ElfCodeInject$<$ T, U, V $>$@{codeinject::inject::ElfCodeInject$<$ T, U, V $>$}!reorder\_shdrs@{reorder\_shdrs}}
\index{reorder\_shdrs@{reorder\_shdrs}!codeinject::inject::ElfCodeInject$<$ T, U, V $>$@{codeinject::inject::ElfCodeInject$<$ T, U, V $>$}}
\doxysubsubsection{\texorpdfstring{reorder\_shdrs()}{reorder\_shdrs()}}
{\footnotesize\ttfamily template$<$typename T , typename U , typename V $>$ \\
void \mbox{\hyperlink{classcodeinject_1_1inject_1_1ElfCodeInject}{codeinject\+::inject\+::\+Elf\+Code\+Inject}}$<$ T, U, V $>$\+::reorder\+\_\+shdrs}

section header를 정렬한다. \mbox{\Hypertarget{classcodeinject_1_1inject_1_1ElfCodeInject_a85ffc80b7cda419f6091c84d5e552f4a}\label{classcodeinject_1_1inject_1_1ElfCodeInject_a85ffc80b7cda419f6091c84d5e552f4a}} 
\index{codeinject::inject::ElfCodeInject$<$ T, U, V $>$@{codeinject::inject::ElfCodeInject$<$ T, U, V $>$}!rewrite\_code\_section@{rewrite\_code\_section}}
\index{rewrite\_code\_section@{rewrite\_code\_section}!codeinject::inject::ElfCodeInject$<$ T, U, V $>$@{codeinject::inject::ElfCodeInject$<$ T, U, V $>$}}
\doxysubsubsection{\texorpdfstring{rewrite\_code\_section()}{rewrite\_code\_section()}}
{\footnotesize\ttfamily template$<$typename T , typename U , typename V $>$ \\
void \mbox{\hyperlink{classcodeinject_1_1inject_1_1ElfCodeInject}{codeinject\+::inject\+::\+Elf\+Code\+Inject}}$<$ T, U, V $>$\+::rewrite\+\_\+code\+\_\+section}

section header을 덮어쓴다. \mbox{\Hypertarget{classcodeinject_1_1inject_1_1ElfCodeInject_a7115cf4a05ba61819b10d6bc842d3fef}\label{classcodeinject_1_1inject_1_1ElfCodeInject_a7115cf4a05ba61819b10d6bc842d3fef}} 
\index{codeinject::inject::ElfCodeInject$<$ T, U, V $>$@{codeinject::inject::ElfCodeInject$<$ T, U, V $>$}!rewrite\_code\_segment@{rewrite\_code\_segment}}
\index{rewrite\_code\_segment@{rewrite\_code\_segment}!codeinject::inject::ElfCodeInject$<$ T, U, V $>$@{codeinject::inject::ElfCodeInject$<$ T, U, V $>$}}
\doxysubsubsection{\texorpdfstring{rewrite\_code\_segment()}{rewrite\_code\_segment()}}
{\footnotesize\ttfamily template$<$typename T , typename U , typename V $>$ \\
void \mbox{\hyperlink{classcodeinject_1_1inject_1_1ElfCodeInject}{codeinject\+::inject\+::\+Elf\+Code\+Inject}}$<$ T, U, V $>$\+::rewrite\+\_\+code\+\_\+segment}

segment를 덮어쓴다. \mbox{\Hypertarget{classcodeinject_1_1inject_1_1ElfCodeInject_a1ce77fd4fbff34aa98ba59ab26bbdf45}\label{classcodeinject_1_1inject_1_1ElfCodeInject_a1ce77fd4fbff34aa98ba59ab26bbdf45}} 
\index{codeinject::inject::ElfCodeInject$<$ T, U, V $>$@{codeinject::inject::ElfCodeInject$<$ T, U, V $>$}!rewrite\_entry\_point@{rewrite\_entry\_point}}
\index{rewrite\_entry\_point@{rewrite\_entry\_point}!codeinject::inject::ElfCodeInject$<$ T, U, V $>$@{codeinject::inject::ElfCodeInject$<$ T, U, V $>$}}
\doxysubsubsection{\texorpdfstring{rewrite\_entry\_point()}{rewrite\_entry\_point()}}
{\footnotesize\ttfamily template$<$typename T , typename U , typename V $>$ \\
void \mbox{\hyperlink{classcodeinject_1_1inject_1_1ElfCodeInject}{codeinject\+::inject\+::\+Elf\+Code\+Inject}}$<$ T, U, V $>$\+::rewrite\+\_\+entry\+\_\+point}

EP를 수정한다. \mbox{\Hypertarget{classcodeinject_1_1inject_1_1ElfCodeInject_a42083348c8a8255b2aaff4f794a7ff49}\label{classcodeinject_1_1inject_1_1ElfCodeInject_a42083348c8a8255b2aaff4f794a7ff49}} 
\index{codeinject::inject::ElfCodeInject$<$ T, U, V $>$@{codeinject::inject::ElfCodeInject$<$ T, U, V $>$}!rewrite\_section\_name@{rewrite\_section\_name}}
\index{rewrite\_section\_name@{rewrite\_section\_name}!codeinject::inject::ElfCodeInject$<$ T, U, V $>$@{codeinject::inject::ElfCodeInject$<$ T, U, V $>$}}
\doxysubsubsection{\texorpdfstring{rewrite\_section\_name()}{rewrite\_section\_name()}}
{\footnotesize\ttfamily template$<$typename T , typename U , typename V $>$ \\
void \mbox{\hyperlink{classcodeinject_1_1inject_1_1ElfCodeInject}{codeinject\+::inject\+::\+Elf\+Code\+Inject}}$<$ T, U, V $>$\+::rewrite\+\_\+section\+\_\+name}

최대의 vaddr을 계산한다. section의 이름을 덮어쓴다. \mbox{\Hypertarget{classcodeinject_1_1inject_1_1ElfCodeInject_a09122c063e2aaeb1291c154b1d494a1f}\label{classcodeinject_1_1inject_1_1ElfCodeInject_a09122c063e2aaeb1291c154b1d494a1f}} 
\index{codeinject::inject::ElfCodeInject$<$ T, U, V $>$@{codeinject::inject::ElfCodeInject$<$ T, U, V $>$}!write\_code@{write\_code}}
\index{write\_code@{write\_code}!codeinject::inject::ElfCodeInject$<$ T, U, V $>$@{codeinject::inject::ElfCodeInject$<$ T, U, V $>$}}
\doxysubsubsection{\texorpdfstring{write\_code()}{write\_code()}}
{\footnotesize\ttfamily template$<$typename T , typename U , typename V $>$ \\
void \mbox{\hyperlink{classcodeinject_1_1inject_1_1ElfCodeInject}{codeinject\+::inject\+::\+Elf\+Code\+Inject}}$<$ T, U, V $>$\+::write\+\_\+code}

바이너리 끝에 코드를 삽입한다. 

\doxysubsection{Member Data Documentation}
\mbox{\Hypertarget{classcodeinject_1_1inject_1_1ElfCodeInject_a4fa95bf04568136acd369533ccc03f08}\label{classcodeinject_1_1inject_1_1ElfCodeInject_a4fa95bf04568136acd369533ccc03f08}} 
\index{codeinject::inject::ElfCodeInject$<$ T, U, V $>$@{codeinject::inject::ElfCodeInject$<$ T, U, V $>$}!m\_name\_index@{m\_name\_index}}
\index{m\_name\_index@{m\_name\_index}!codeinject::inject::ElfCodeInject$<$ T, U, V $>$@{codeinject::inject::ElfCodeInject$<$ T, U, V $>$}}
\doxysubsubsection{\texorpdfstring{m\_name\_index}{m\_name\_index}}
{\footnotesize\ttfamily template$<$typename T , typename U , typename V $>$ \\
int \mbox{\hyperlink{classcodeinject_1_1inject_1_1ElfCodeInject}{codeinject\+::inject\+::\+Elf\+Code\+Inject}}$<$ T, U, V $>$\+::m\+\_\+name\+\_\+index}

수정할 섹션의 이름 인덱스 \mbox{\Hypertarget{classcodeinject_1_1inject_1_1ElfCodeInject_acfd9e5cf20f07b8c0d5dcc29bf7e7512}\label{classcodeinject_1_1inject_1_1ElfCodeInject_acfd9e5cf20f07b8c0d5dcc29bf7e7512}} 
\index{codeinject::inject::ElfCodeInject$<$ T, U, V $>$@{codeinject::inject::ElfCodeInject$<$ T, U, V $>$}!m\_program\_header\_index@{m\_program\_header\_index}}
\index{m\_program\_header\_index@{m\_program\_header\_index}!codeinject::inject::ElfCodeInject$<$ T, U, V $>$@{codeinject::inject::ElfCodeInject$<$ T, U, V $>$}}
\doxysubsubsection{\texorpdfstring{m\_program\_header\_index}{m\_program\_header\_index}}
{\footnotesize\ttfamily template$<$typename T , typename U , typename V $>$ \\
int \mbox{\hyperlink{classcodeinject_1_1inject_1_1ElfCodeInject}{codeinject\+::inject\+::\+Elf\+Code\+Inject}}$<$ T, U, V $>$\+::m\+\_\+program\+\_\+header\+\_\+index}

수정할 프로그램 헤더의 인덱스 

The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
inject/inject.\+h\item 
inject/inject.\+cpp\end{DoxyCompactItemize}
