\hypertarget{winnt_8h_source}{}\doxysection{winnt.\+h}
\label{winnt_8h_source}\index{include/winnt.h@{include/winnt.h}}

\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{keyword}{typedef}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{short}\ WORD;}
\DoxyCodeLine{00002\ \textcolor{keyword}{typedef}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ DWORD;}
\DoxyCodeLine{00003\ \textcolor{keyword}{typedef}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ BYTE;}
\DoxyCodeLine{00004\ \textcolor{keyword}{typedef}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{long}\ \textcolor{keywordtype}{long}\ ULONGLONG;}
\DoxyCodeLine{00005\ }
\DoxyCodeLine{00006\ \textcolor{comment}{//\ PE\ 코드\ 삽입을\ 위해\ 필요한\ 정보\ }}
\DoxyCodeLine{00007\ \textcolor{comment}{//\ section\ header의\ 마지막\ 파일\ 오프셋\ -\/\ 첫번째\ Section의\ 코드\ >=\ 40(IMAGE\_SECTION\_HEADER의\ 크기)}}
\DoxyCodeLine{00008\ }
\DoxyCodeLine{00009\ \textcolor{keyword}{typedef}\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct__IMAGE__DOS__HEADER}{\_IMAGE\_DOS\_HEADER}}\ \{}
\DoxyCodeLine{00010\ \ \ \ \ WORD\ e\_magic;\ \ \ \ \textcolor{comment}{/*\ 00:\ MZ\ Header\ signature\ */}}
\DoxyCodeLine{00011\ \ \ \ \ WORD\ e\_cblp;\ \ \ \ \ \textcolor{comment}{/*\ 02:\ Bytes\ on\ last\ page\ of\ file\ */}}
\DoxyCodeLine{00012\ \ \ \ \ WORD\ e\_cp;\ \ \ \ \ \ \ \textcolor{comment}{/*\ 04:\ Pages\ in\ file\ */}}
\DoxyCodeLine{00013\ \ \ \ \ WORD\ e\_crlc;\ \ \ \ \ \textcolor{comment}{/*\ 06:\ Relocations\ */}}
\DoxyCodeLine{00014\ \ \ \ \ WORD\ e\_cparhdr;\ \ \textcolor{comment}{/*\ 08:\ Size\ of\ header\ in\ paragraphs\ */}}
\DoxyCodeLine{00015\ \ \ \ \ WORD\ e\_minalloc;\ \textcolor{comment}{/*\ 0a:\ Minimum\ extra\ paragraphs\ needed\ */}}
\DoxyCodeLine{00016\ \ \ \ \ WORD\ e\_maxalloc;\ \textcolor{comment}{/*\ 0c:\ Maximum\ extra\ paragraphs\ needed\ */}}
\DoxyCodeLine{00017\ \ \ \ \ WORD\ e\_ss;\ \ \ \ \ \ \ \textcolor{comment}{/*\ 0e:\ Initial\ (relative)\ SS\ value\ */}}
\DoxyCodeLine{00018\ \ \ \ \ WORD\ e\_sp;\ \ \ \ \ \ \ \textcolor{comment}{/*\ 10:\ Initial\ SP\ value\ */}}
\DoxyCodeLine{00019\ \ \ \ \ WORD\ e\_csum;\ \ \ \ \ \textcolor{comment}{/*\ 12:\ Checksum\ */}}
\DoxyCodeLine{00020\ \ \ \ \ WORD\ e\_ip;\ \ \ \ \ \ \ \textcolor{comment}{/*\ 14:\ Initial\ IP\ value\ */}}
\DoxyCodeLine{00021\ \ \ \ \ WORD\ e\_cs;\ \ \ \ \ \ \ \textcolor{comment}{/*\ 16:\ Initial\ (relative)\ CS\ value\ */}}
\DoxyCodeLine{00022\ \ \ \ \ WORD\ e\_lfarlc;\ \ \ \textcolor{comment}{/*\ 18:\ File\ address\ of\ relocation\ table\ */}}
\DoxyCodeLine{00023\ \ \ \ \ WORD\ e\_ovno;\ \ \ \ \ \textcolor{comment}{/*\ 1a:\ Overlay\ number\ */}}
\DoxyCodeLine{00024\ \ \ \ \ WORD\ e\_res[4];\ \ \ \textcolor{comment}{/*\ 1c:\ Reserved\ words\ */}}
\DoxyCodeLine{00025\ \ \ \ \ WORD\ e\_oemid;\ \ \ \ \textcolor{comment}{/*\ 24:\ OEM\ identifier\ (for\ e\_oeminfo)\ */}}
\DoxyCodeLine{00026\ \ \ \ \ WORD\ e\_oeminfo;\ \ \textcolor{comment}{/*\ 26:\ OEM\ information;\ e\_oemid\ specific\ */}}
\DoxyCodeLine{00027\ \ \ \ \ WORD\ e\_res2[10];\ \textcolor{comment}{/*\ 28:\ Reserved\ words\ */}}
\DoxyCodeLine{00028\ \ \ \ \ DWORD\ e\_lfanew;\ \ \textcolor{comment}{/*\ 3c:\ Offset\ to\ extended\ header\ */}}
\DoxyCodeLine{00029\ \}\ \mbox{\hyperlink{struct__IMAGE__DOS__HEADER}{IMAGE\_DOS\_HEADER}},\ \mbox{\hyperlink{struct__IMAGE__DOS__HEADER}{PE\_DOS\_HEADER}};}
\DoxyCodeLine{00030\ }
\DoxyCodeLine{00031\ \textcolor{keyword}{typedef}\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct__IMAGE__FILE__HEADER}{\_IMAGE\_FILE\_HEADER}}\ \{}
\DoxyCodeLine{00032\ \ \ \ \ WORD\ Machine;}
\DoxyCodeLine{00033\ \ \ \ \ WORD\ NumberOfSections;\ \textcolor{comment}{/*\ PE\ Inject를\ 위해\ 필요한\ 정보\ :\ 섹션을\ 추가하기\ 위해서\ */}}
\DoxyCodeLine{00034\ \ \ \ \ DWORD\ TimeDateStamp;}
\DoxyCodeLine{00035\ \ \ \ \ DWORD\ PointerToSymbolTable;}
\DoxyCodeLine{00036\ \ \ \ \ DWORD\ NumberOfSymbols;}
\DoxyCodeLine{00037\ \ \ \ \ WORD\ SizeOfOptionalHeader;}
\DoxyCodeLine{00038\ \ \ \ \ WORD\ Characteristics;\ \textcolor{comment}{/*\ PE\ Inject를\ 위해\ 필요한\ 정보\ :\ 보안\ Flag\ 삭제\ */}}
\DoxyCodeLine{00039\ \}\ \mbox{\hyperlink{struct__IMAGE__FILE__HEADER}{IMAGE\_FILE\_HEADER}},\ *\mbox{\hyperlink{struct__IMAGE__FILE__HEADER}{PIMAGE\_FILE\_HEADER}};}
\DoxyCodeLine{00040\ }
\DoxyCodeLine{00041\ \textcolor{keyword}{typedef}\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct__IMAGE__DATA__DIRECTORY}{\_IMAGE\_DATA\_DIRECTORY}}\ \{}
\DoxyCodeLine{00042\ \ \ \ \ DWORD\ VirtualAddress;}
\DoxyCodeLine{00043\ \ \ \ \ DWORD\ Size;}
\DoxyCodeLine{00044\ \}\ \mbox{\hyperlink{struct__IMAGE__DATA__DIRECTORY}{IMAGE\_DATA\_DIRECTORY}},\ *\mbox{\hyperlink{struct__IMAGE__DATA__DIRECTORY}{PIMAGE\_DATA\_DIRECTORY}};}
\DoxyCodeLine{00045\ }
\DoxyCodeLine{00046\ \textcolor{comment}{//\#define\ IMAGE\_NUMBEROF\_DIRECTORY\_ENTRIES\ 16}}
\DoxyCodeLine{00047\ \textcolor{keyword}{typedef}\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct__IMAGE__OPTIONAL__HEADER64}{\_IMAGE\_OPTIONAL\_HEADER64}}\ \{}
\DoxyCodeLine{00048\ \ \ \ \ WORD\ Magic;\ \textcolor{comment}{/*\ 0x20b\ */}}
\DoxyCodeLine{00049\ \ \ \ \ BYTE\ MajorLinkerVersion;}
\DoxyCodeLine{00050\ \ \ \ \ BYTE\ MinorLinkerVersion;}
\DoxyCodeLine{00051\ \ \ \ \ DWORD\ SizeOfCode;}
\DoxyCodeLine{00052\ \ \ \ \ DWORD\ SizeOfInitializedData;}
\DoxyCodeLine{00053\ \ \ \ \ DWORD\ SizeOfUninitializedData;}
\DoxyCodeLine{00054\ \ \ \ \ DWORD\ AddressOfEntryPoint;\ \textcolor{comment}{/*\ PE\ Inject를\ 위해\ 필요한\ 정보\ :\ Entry\ Point\ */}}
\DoxyCodeLine{00055\ \ \ \ \ DWORD\ BaseOfCode;\ }
\DoxyCodeLine{00056\ \ \ \ \ ULONGLONG\ ImageBase;}
\DoxyCodeLine{00057\ \ \ \ \ DWORD\ SectionAlignment;\ \textcolor{comment}{/*\ PE\ Inject를\ 위해\ 필요한\ 정보\ :\ 가상\ 메모리에\ section을\ 추가할때\ 시작,\ 끝\ 지점\ 메모리\ 값\ 계산을\ 위해\ */}}
\DoxyCodeLine{00058\ \ \ \ \ DWORD\ FileAlignment;\ \ \ \ \textcolor{comment}{/*\ PE\ Inject를\ 위해\ 필요한\ 정보\ :\ 파일에서\ section을\ 추가할때\ 시작,\ 끝\ 지점\ 파일\ 오프셋\ 계산을\ 위해\ */}}
\DoxyCodeLine{00059\ \ \ \ \ WORD\ MajorOperatingSystemVersion;}
\DoxyCodeLine{00060\ \ \ \ \ WORD\ MinorOperatingSystemVersion;}
\DoxyCodeLine{00061\ \ \ \ \ WORD\ MajorImageVersion;}
\DoxyCodeLine{00062\ \ \ \ \ WORD\ MinorImageVersion;}
\DoxyCodeLine{00063\ \ \ \ \ WORD\ MajorSubsystemVersion;}
\DoxyCodeLine{00064\ \ \ \ \ WORD\ MinorSubsystemVersion;}
\DoxyCodeLine{00065\ \ \ \ \ DWORD\ Win32VersionValue;}
\DoxyCodeLine{00066\ \ \ \ \ DWORD\ SizeOfImage;\ \textcolor{comment}{/*\ PE\ Inject를\ 위해\ 필요한\ 정보\ :\ 가상\ 메모리에\ 로드됐을때의\ 전체\ 메모리\ 크기\ */}}
\DoxyCodeLine{00067\ \ \ \ \ DWORD\ SizeOfHeaders;}
\DoxyCodeLine{00068\ \ \ \ \ DWORD\ CheckSum;}
\DoxyCodeLine{00069\ \ \ \ \ WORD\ Subsystem;}
\DoxyCodeLine{00070\ \ \ \ \ WORD\ DllCharacteristics;}
\DoxyCodeLine{00071\ \ \ \ \ ULONGLONG\ SizeOfStackReserve;}
\DoxyCodeLine{00072\ \ \ \ \ ULONGLONG\ SizeOfStackCommit;}
\DoxyCodeLine{00073\ \ \ \ \ ULONGLONG\ SizeOfHeapReserve;}
\DoxyCodeLine{00074\ \ \ \ \ ULONGLONG\ SizeOfHeapCommit;}
\DoxyCodeLine{00075\ \ \ \ \ DWORD\ LoaderFlags;}
\DoxyCodeLine{00076\ \ \ \ \ DWORD\ NumberOfRvaAndSizes;}
\DoxyCodeLine{00077\ \ \ \ \ \textcolor{comment}{//IMAGE\_DATA\_DIRECTORY\ DataDirectory[IMAGE\_NUMBEROF\_DIRECTORY\_ENTRIES];}}
\DoxyCodeLine{00078\ \}\ \mbox{\hyperlink{struct__IMAGE__OPTIONAL__HEADER64}{IMAGE\_OPTIONAL\_HEADER64}},\ *\mbox{\hyperlink{struct__IMAGE__OPTIONAL__HEADER64}{PIMAGE\_OPTIONAL\_HEADER64}};}
\DoxyCodeLine{00079\ }
\DoxyCodeLine{00080\ \textcolor{keyword}{typedef}\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct__IMAGE__NT__HEADERS64}{\_IMAGE\_NT\_HEADERS64}}\ \{}
\DoxyCodeLine{00081\ \ \ \ \ DWORD\ Signature;}
\DoxyCodeLine{00082\ \ \ \ \ \mbox{\hyperlink{struct__IMAGE__FILE__HEADER}{IMAGE\_FILE\_HEADER}}\ FileHeader;}
\DoxyCodeLine{00083\ \ \ \ \ \mbox{\hyperlink{struct__IMAGE__OPTIONAL__HEADER64}{IMAGE\_OPTIONAL\_HEADER64}}\ OptionalHeader;}
\DoxyCodeLine{00084\ \}\ \mbox{\hyperlink{struct__IMAGE__NT__HEADERS64}{IMAGE\_NT\_HEADERS64}},\ \mbox{\hyperlink{struct__IMAGE__NT__HEADERS64}{PE64\_HEADERS}};}
\DoxyCodeLine{00085\ }
\DoxyCodeLine{00086\ \textcolor{keyword}{typedef}\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct__IMAGE__OPTIONAL__HEADER}{\_IMAGE\_OPTIONAL\_HEADER}}\ \{}
\DoxyCodeLine{00087\ \ \ \ \ \textcolor{comment}{/*\ Standard\ fields\ */}}
\DoxyCodeLine{00088\ }
\DoxyCodeLine{00089\ \ \ \ \ WORD\ Magic;\ \textcolor{comment}{/*\ 0x10b\ or\ 0x107\ */}\ \textcolor{comment}{/*\ 0x00\ */}}
\DoxyCodeLine{00090\ \ \ \ \ BYTE\ MajorLinkerVersion;}
\DoxyCodeLine{00091\ \ \ \ \ BYTE\ MinorLinkerVersion;}
\DoxyCodeLine{00092\ \ \ \ \ DWORD\ SizeOfCode;}
\DoxyCodeLine{00093\ \ \ \ \ DWORD\ SizeOfInitializedData;}
\DoxyCodeLine{00094\ \ \ \ \ DWORD\ SizeOfUninitializedData;}
\DoxyCodeLine{00095\ \ \ \ \ DWORD\ AddressOfEntryPoint;\ \textcolor{comment}{/*\ 0x10,\ PE\ Inject를\ 위해\ 필요한\ 정보\ :\ Entry\ Point\ \ */}}
\DoxyCodeLine{00096\ \ \ \ \ DWORD\ BaseOfCode;}
\DoxyCodeLine{00097\ \ \ \ \ DWORD\ BaseOfData;}
\DoxyCodeLine{00098\ }
\DoxyCodeLine{00099\ \ \ \ \ \textcolor{comment}{/*\ NT\ additional\ fields\ */}}
\DoxyCodeLine{00100\ }
\DoxyCodeLine{00101\ \ \ \ \ DWORD\ ImageBase;}
\DoxyCodeLine{00102\ \ \ \ \ DWORD\ SectionAlignment;\ \textcolor{comment}{/*\ 0x20,\ PE\ Inject를\ 위해\ 필요한\ 정보\ :\ 가상\ 메모리에\ section을\ 추가할때\ 시작,\ 끝\ 지점\ 메모리\ 값\ 계산을\ 위해\ */}}
\DoxyCodeLine{00103\ \ \ \ \ DWORD\ FileAlignment;\ \textcolor{comment}{/*\ PE\ Inject를\ 위해\ 필요한\ 정보\ :\ 파일에서\ section을\ 추가할때\ 시작,\ 끝\ 지점\ 파일\ 오프셋\ 계산을\ 위해\ */}}
\DoxyCodeLine{00104\ \ \ \ \ WORD\ MajorOperatingSystemVersion;}
\DoxyCodeLine{00105\ \ \ \ \ WORD\ MinorOperatingSystemVersion;}
\DoxyCodeLine{00106\ \ \ \ \ WORD\ MajorImageVersion;}
\DoxyCodeLine{00107\ \ \ \ \ WORD\ MinorImageVersion;}
\DoxyCodeLine{00108\ \ \ \ \ WORD\ MajorSubsystemVersion;\ \textcolor{comment}{/*\ 0x30\ */}}
\DoxyCodeLine{00109\ \ \ \ \ WORD\ MinorSubsystemVersion;}
\DoxyCodeLine{00110\ \ \ \ \ DWORD\ Win32VersionValue;}
\DoxyCodeLine{00111\ \ \ \ \ DWORD\ SizeOfImage;\ \textcolor{comment}{/*\ PE\ Inject를\ 위해\ 필요한\ 정보\ :\ 가상\ 메모리에\ 로드됐을때의\ 전체\ 메모리\ 크기\ */}}
\DoxyCodeLine{00112\ \ \ \ \ DWORD\ SizeOfHeaders;}
\DoxyCodeLine{00113\ \ \ \ \ DWORD\ CheckSum;\ \textcolor{comment}{/*\ 0x40\ */}}
\DoxyCodeLine{00114\ \ \ \ \ WORD\ Subsystem;}
\DoxyCodeLine{00115\ \ \ \ \ WORD\ DllCharacteristics;}
\DoxyCodeLine{00116\ \ \ \ \ DWORD\ SizeOfStackReserve;}
\DoxyCodeLine{00117\ \ \ \ \ DWORD\ SizeOfStackCommit;}
\DoxyCodeLine{00118\ \ \ \ \ DWORD\ SizeOfHeapReserve;\ \textcolor{comment}{/*\ 0x50\ */}}
\DoxyCodeLine{00119\ \ \ \ \ DWORD\ SizeOfHeapCommit;}
\DoxyCodeLine{00120\ \ \ \ \ DWORD\ LoaderFlags;}
\DoxyCodeLine{00121\ \ \ \ \ DWORD\ NumberOfRvaAndSizes;}
\DoxyCodeLine{00122\ \ \ \ \ \textcolor{comment}{//IMAGE\_DATA\_DIRECTORY\ DataDirectory[IMAGE\_NUMBEROF\_DIRECTORY\_ENTRIES];\ /*\ 0x60\ */\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ /*\ 0xE0\ */}}
\DoxyCodeLine{00123\ \}\ \mbox{\hyperlink{struct__IMAGE__OPTIONAL__HEADER}{IMAGE\_OPTIONAL\_HEADER32}},\ *\mbox{\hyperlink{struct__IMAGE__OPTIONAL__HEADER}{PIMAGE\_OPTIONAL\_HEADER32}};}
\DoxyCodeLine{00124\ }
\DoxyCodeLine{00125\ \textcolor{keyword}{typedef}\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct__IMAGE__NT__HEADERS}{\_IMAGE\_NT\_HEADERS}}\ \{}
\DoxyCodeLine{00126\ \ \ \ \ DWORD\ Signature;\ \textcolor{comment}{/*\ "{}PE"{}\(\backslash\)0\(\backslash\)0\ */}\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ 0x00\ */}}
\DoxyCodeLine{00127\ \ \ \ \ \mbox{\hyperlink{struct__IMAGE__FILE__HEADER}{IMAGE\_FILE\_HEADER}}\ FileHeader;\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ 0x04\ */}}
\DoxyCodeLine{00128\ \ \ \ \ \mbox{\hyperlink{struct__IMAGE__OPTIONAL__HEADER}{IMAGE\_OPTIONAL\_HEADER32}}\ OptionalHeader;\ \textcolor{comment}{/*\ 0x18\ */}}
\DoxyCodeLine{00129\ \}\ \mbox{\hyperlink{struct__IMAGE__NT__HEADERS}{IMAGE\_NT\_HEADERS32}},\ \mbox{\hyperlink{struct__IMAGE__NT__HEADERS}{PE32\_HEADERS}};}
\DoxyCodeLine{00134\ \textcolor{preprocessor}{\#define\ IMAGE\_SIZEOF\_SHORT\_NAME\ 8}}
\DoxyCodeLine{00135\ \textcolor{keyword}{typedef}\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct__IMAGE__SECTION__HEADER}{\_IMAGE\_SECTION\_HEADER}}\ \{}
\DoxyCodeLine{00136\ \ \ \ \ BYTE\ Name[IMAGE\_SIZEOF\_SHORT\_NAME];}
\DoxyCodeLine{00137\ \ \ \ \ \textcolor{keyword}{union\ }\{}
\DoxyCodeLine{00138\ \ \ \ \ \ \ \ \ DWORD\ PhysicalAddress;}
\DoxyCodeLine{00139\ \ \ \ \ \ \ \ \ DWORD\ VirtualSize;\ \textcolor{comment}{//\ PE\ inject를\ 위해\ 필요한\ 정보}}
\DoxyCodeLine{00140\ \ \ \ \ \}\ Misc;}
\DoxyCodeLine{00141\ \ \ \ \ DWORD\ VirtualAddress;}
\DoxyCodeLine{00142\ \ \ \ \ DWORD\ SizeOfRawData;}
\DoxyCodeLine{00143\ \ \ \ \ DWORD\ PointerToRawData;\ \textcolor{comment}{//\ PE\ inject를\ 위해\ 필요한\ 정보}}
\DoxyCodeLine{00144\ \ \ \ \ DWORD\ PointerToRelocations;}
\DoxyCodeLine{00145\ \ \ \ \ DWORD\ PointerToLinenumbers;}
\DoxyCodeLine{00146\ \ \ \ \ WORD\ NumberOfRelocations;}
\DoxyCodeLine{00147\ \ \ \ \ WORD\ NumberOfLinenumbers;}
\DoxyCodeLine{00148\ \ \ \ \ DWORD\ Characteristics;\ \textcolor{comment}{//\ PE\ inject를\ 위해\ 필요한\ 정보}}
\DoxyCodeLine{00149\ \}\ \mbox{\hyperlink{struct__IMAGE__SECTION__HEADER}{IMAGE\_SECTION\_HEADER}},\ \mbox{\hyperlink{struct__IMAGE__SECTION__HEADER}{PE\_SECTION\_HEADER}};}

\end{DoxyCode}
